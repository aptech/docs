
inthp4
==============================================

Purpose
----------------

Integrates a user-defined function over the [a, b] interval.

Format
----------------
.. function:: inthp4(&f, pds, ctl, c)

    :param &f: pointer to the procedure containing the function to be integrated.
    :type &f: scalar

    :param pds: pointer to instance of a DS structure. The members of the DS are:
    :type pds: scalar

    .. csv-table::
        :widths: auto

        "pds->dataMatrix", "NxK matrix."
        "pds->dataArray", "NxKxL... array."
        "pds->vnames", "string array."
        "pds->dsname", "string."
        "pds->type", "scalar."
        "The contents, if any, are set by the user and are passed by inthp1 to the user-provided function without modification."

    :param ctl: 
    :type ctl: instance of an inthpControl structure with members

    .. csv-table::
        :widths: auto

        "ctl.maxEvaluations", "scalar, maximum number of function evaluations, default = 1e5;"
        "ctl.p", "scalar, termination parameter"
        "", "0", "heuristic termination, default."
        "", "1", "deterministic termination with infinity norm."
        "", "2,...", "deterministic termination with p-th norm."
        "ctl.d", "scalar termination parameter"
        "", "1", "if heuristic termination"
        "", "0 <ctl.d < π/2", "if deterministic termination"
        "ctl.eps", "scalar, relative error bound. Default = 1e-6."
        "A default ctl can be generated by calling inthpControlCreate."

    :param c: , upper and lower limits of integration, the ﬁrst row
        contains upper limits and the second row the lower.
    :type c: 2×N vector

    :returns: y (*Nx1 vector*), the estimated integrals of f(x)
        evaluated over the interval [a, b].

Remarks
-------

The user-provided function must have the following format

::

                   f(struct DS *pds, x)

where

+-----------------+-----------------------------------------------------+
| pds             | scalar, pointer to an instance of a DS structure.   |
+-----------------+-----------------------------------------------------+
| x               | scalar, value at which integral will be evaluated.  |
+-----------------+-----------------------------------------------------+

If ctl.d can be specified (see Sikorski and Stenger, 1984),
deterministic termination can be specified and accuracy guaranteed. if
not, the heuristic method can be used and the value of ctl.d is
disregarded.

The pointer to the instance of the data structure, pds, is passed
untouched to the user-provided procedure computing the function to be
integrated. Any information needed by that function can be put into that
data structure.


Examples
----------------

::

    #include inthp.sdf
     
    proc fct(struct DS *pd0, x);
       local a,b,c;
       a = pd0->dataMatrix[1];
       b = pd0->dataMatrix[2];
       c = pd0->dataMatrix[3];
       retp( 1/sqrt(a*x*x + b*x + c));
    endp;
     
    struct DS d0;
    struct DS *pd0;
     
    struct inthpControl c0;
    c0 = inthpControlCreate;
     
    c0.p = 2;
    c0.d = pi/2;
     
    a = -1;
    b = -2;
    c = 3;
    pd0 = &d0;
    d0.dataMatrix = a|b|c;
     
    lim = 1 | -1;
     
    r = inthp4(&fct,pd0,c0,lim);
     
    format /ld 16,10;
    print r;
    print pi/2;

produces the following output:

::

    1.5707962283
     1.5707963268

References
++++++++++

#. "Optimal Quadratures in H_p Spaces" by K. Sikorski and F. Stenger,
   ACM Transactions on Mathematical Software, 10(2):140-151, June 1984.

Source
------

inthp.src

.. seealso:: Functions :func:`inthpControlCreate`, :func:`inthp1`, :func:`inthp2`, :func:`inthp3`

intergrate user defined interval
